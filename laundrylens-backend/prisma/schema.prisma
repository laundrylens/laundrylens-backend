generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// Enums
// ============================================

enum SymbolCategory {
  WASH
  BLEACH
  DRY
  IRON
  DRYCLEAN
}

enum Frequency {
  ALWAYS
  OFTEN
  SOMETIMES
}

// ============================================
// Models
// ============================================

model LaundrySymbol {
  id        String         @id @default(uuid())
  category  SymbolCategory
  code      String         @unique
  iconUrl   String?        @map("icon_url")
  createdAt DateTime       @default(now()) @map("created_at")

  translations    SymbolTranslation[]
  materialSymbols MaterialSymbol[]

  @@map("laundry_symbols")
}

model SymbolTranslation {
  id          String @id @default(uuid())
  symbolId    String @map("symbol_id")
  countryCode String @map("country_code")
  name        String
  shortDesc   String @map("short_desc")
  detailDesc  String @map("detail_desc")

  symbol LaundrySymbol @relation(fields: [symbolId], references: [id], onDelete: Cascade)

  @@unique([symbolId, countryCode])
  @@map("symbol_translations")
}

model Material {
  id          String   @id @default(uuid())
  code        String   @unique
  nameKo      String   @map("name_ko")
  nameEn      String   @map("name_en")
  nameJp      String   @map("name_jp")
  description String?
  careTips    String?  @map("care_tips")
  createdAt   DateTime @default(now()) @map("created_at")

  materialSymbols MaterialSymbol[]

  @@map("materials")
}

model MaterialSymbol {
  id         String    @id @default(uuid())
  materialId String    @map("material_id")
  symbolId   String    @map("symbol_id")
  frequency  Frequency
  note       String?

  material Material      @relation(fields: [materialId], references: [id], onDelete: Cascade)
  symbol   LaundrySymbol @relation(fields: [symbolId], references: [id], onDelete: Cascade)

  @@unique([materialId, symbolId])
  @@map("material_symbols")
}

model UsageLog {
  id        String   @id @default(uuid())
  guestId   String   @map("guest_id")
  action    String
  createdAt DateTime @default(now()) @map("created_at")

  @@index([guestId, createdAt])
  @@map("usage_logs")
}
